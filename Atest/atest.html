<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Advanced Pinterest Style Layout</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0; padding: 20px;
    background: #f4f4f4;
  }
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    grid-auto-rows: 10px; /* base row height */
    gap: 15px;
  }
  .grid-item {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }
  .grid-item img {
    width: 100%;
    display: block;
    border-radius: 8px 8px 0 0;
  }
  .caption {
    padding: 10px;
    font-size: 14px;
    color: #555;
  }
</style>
</head>
<body>

<div class="grid" id="grid">
  <div class="grid-item">
    <img src="https://via.placeholder.com/300x400" alt="Photo 1" />
    <div class="caption">Photo 1</div>
  </div>
  <div class="grid-item">
    <img src="https://via.placeholder.com/300x250" alt="Photo 2" />
    <div class="caption">Photo 2</div>
  </div>
  <div class="grid-item">
    <img src="https://via.placeholder.com/300x450" alt="Photo 3" />
    <div class="caption">Photo 3</div>
  </div>
  <div class="grid-item">
    <img src="https://via.placeholder.com/300x350" alt="Photo 4" />
    <div class="caption">Photo 4</div>
  </div>
  <div class="grid-item">
    <img src="https://via.placeholder.com/300x320" alt="Photo 5" />
    <div class="caption">Photo 5</div>
  </div>
  <div class="grid-item">
    <img src="https://via.placeholder.com/300x280" alt="Photo 6" />
    <div class="caption">Photo 6</div>
  </div>
</div>

<script>
  function resizeAllGridItems() {
    const grid = document.getElementById('grid');
    const allItems = grid.getElementsByClassName('grid-item');
    for(let item of allItems) {
      resizeGridItem(item);
    }
  }

  function resizeGridItem(item) {
    const grid = document.getElementById('grid');
    const rowHeight = parseInt(window.getComputedStyle(grid).getPropertyValue('grid-auto-rows'));
    const rowGap = parseInt(window.getComputedStyle(grid).getPropertyValue('gap'));
    const contentHeight = item.querySelector('img').getBoundingClientRect().height +
                          item.querySelector('.caption').getBoundingClientRect().height;
    const rowSpan = Math.ceil((contentHeight + rowGap) / (rowHeight + rowGap));
    item.style.gridRowEnd = `span ${rowSpan}`;
  }

  window.onload = resizeAllGridItems;
  window.addEventListener('resize', resizeAllGridItems);
</script>

</body>
</html>